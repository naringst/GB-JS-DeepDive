# 15장 let, const 키워드와 블록 레벨 스코프

# 15.1 var 키워드로 선언한 변수의 문제점

---

- var 키워드로 선언한 변수의 특징

## 15.1.1 변수 중복 선언 허용

var 키워드로 선언한 변수는 중복 선언이 가능하다.

```jsx
var x = 1;
var y = 1;

var x = 100;

var y;

console.log(x);
console.log(y);
```

- 위 예시에서 x,y는 중복선언되었다. 이처럼 var 키워드로 선언한 변수를 중복 선언하면 초기화문 유무에 따라 다르게 동작한다.
  - 초기화 문이 있는 변수 선언문 : var 키워드가 없는 것처럼 동작. 새로운 값이 할당
  - 초기화문이 없는 변수 선언문 : 무시된다.

## 15.2.1 함수 레벨 스코프

- var 키워드로 선언한 변수는 함수의 코드 블록만을 지역 스코프로 인정한다.
- 따라서 함수 외부에서 var 키워드 선언시 코드블록 내에서 선언해도 모두 전역 변수가 된다.

```jsx
var x = 1;

if (true) {
  var x = 10;
}

console.log(x); //10
```

- for문의 변수 선언문에서 var 키어드로 선언한 변수도 전역 변수가 된다.
- 이러한 함수 레벨 스코프는 전역 변수르 남발할 가능성을 높인다.

## 15.1.3 변수 호이스팅

- var 키워드로 변수를 선언하면 변수 호이스팅에 의해 변수 선언문이 스코프의 선두로 끌어 올려진 것처럼 동작한다.
- 즉 var 키워드로 선언한 변수는 변수 선언문 이전에 참조 가능

```jsx
console.log(foo); // 2. 따라서 여기서 undefined

foo = 123; //123이 할당

console.log(foo); //123

var foo; //1. 여기가 런타임 이전에 암묵적 실행 (호이스팅)
```

- 하지만 변수 선언문 이전에 변수를 참조하는 것은 가독성을 떨어뜨리고 오류 발생 여지

# 15.2 let 키워드

---

- var의 단점 보완을 위해 ES6에서 도입

## 15.2.1 변수 중복 선언 금지

- var 키워드로 이름이 동일한 변수를 중복 선언이 가능하다. 이는 의도치 않은 값의 재할당을 발생시킬 수 있으므로 부작용이 발생한다.
- let 키워드로는 변수 중복 선언시 문법 에러가 발생한다.

```jsx
var foo = 123;

var foo = 456; //가능

let bar = 123;

let bar = 456; // syntaxError 발생
```

## 15.2.2 블록 레벨 스코프

- `var 키워드`로 선언한 변수는 오로지 코드 블록만을 지역스코프로 인정한다. : `함수 레벨 스코프`
- `let 키워드`로 선언한 변수는 모든 코드 블록을 지역 스코프로 인정한다 : `블록 레벨 스코프`
- 이때 함수 스코프 내의 for 문과 같은 경우에 함수레벨 스코프에 중첩된다.

## 15.2.3 변수 호이스팅

- let 키워드는 변수 호이스팅이 발생하지 않는 것처럼 동작한다.
- let 키워드는 var 과 다르게 선언 단계와 초기화 단계가 분리되어 진행된다.
- 런타임 이전에 암묵적으로 선언 단계가 먼저 실행되긴 하지만, 초기화 단계는 변수 선언문에 도달했을 때 실행된다.
- 따라서 초기화단계 이전에 변수에 접근하려고 하면 참조 에러가 발생한다.
- 이러한 특징 떄문에 let 변수는 스코프의 시작 지점부터 초기화 단계 시작 지점까지 변수를 참조할 수 없다.
- 이렇게 스코프 시작 지점부터 초기화 시작 지점까지 변수 참조할 수 없는 구간을 `일시적 사각지대(Temperal Dead Zone)`라고 부른다.

- 결국 변수 호이스팅이 발생하지 않는 것처럼 보이지만, 그렇지 않다.

```jsx
let foo = 1; //전역 변수

{
  console.log(foo); // ReferenceError : cannot access foo before initialization
  let foo = 2;
}
```

- 호이스팅이 발생하지 않는다면 전역변수 foo의 값을 출력해야 한다.
  - 호이스팅이 일어났기 때문에 새로운 블록 레벨 스코프 시작점에서 지역변수 foo가 선언된 것처럼 되었고, 아직 초기화되지 않았기 때문에 참조 에러가 난다.
  - 호이스팅이 일어나지 않았다면 위에서부터 읽어 내려가므로 foo=1인 전역 변수의 값을 출력해야 한다.
- 자바스크립트는 ES6에서 도입된 let, const를 포함해 모든 선언을 호이스팅한다.
